"use strict";var map,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,markers=[];document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines()});var fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,n=document.getElementById("neighborhoods-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.cuisines,n=document.getElementById("cuisines-select");e.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})};window.initMap=function(){var e={lat:40.722216,lng:-73.987501},t=document.getElementById("map"),n=!1;t.addEventListener("click",function(){n||(self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:e,scrollwheel:!1}),addMarkersToMap(),n=!0)}),updateRestaurants()};var updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,s=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,s,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",DBHelper.cleanImageCache(),self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.getElementById("restaurants-list");t.innerHTML="",e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li");t.className="restaurant";var n=document.createElement("picture");t.append(n);var a=document.createElement("source");a.media="(min-width: 750px)",a.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)+"-800_large.webp"),a.type="image/webp",n.append(a);var r=document.createElement("source");r.media="(min-width: 750px)",r.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)+"-800_large.jpg"),r.type="image/jpeg",n.append(r);var s=document.createElement("source");s.media="(min-width: 500px)",s.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)+"_medium.webp"),s.type="image/webp",n.append(s);var o=document.createElement("source");o.media="(min-width: 500px)",o.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)+"_medium.jpg"),o.type="image/jpeg",n.append(o);var i=document.createElement("source");i.setAttribute("data-srcset",DBHelper.imageUrlForRestaurant(e)+".webp"),i.type="image/webp",n.append(i);var c=document.createElement("img");c.className="restaurant-img",c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",c.setAttribute("data-src",DBHelper.imageUrlForRestaurant(e)+".jpg"),c.alt=e.name+" is a "+e.cuisine_type+" restaurant in "+e.address+".",n.append(c);var u=document.createElement("h3");u.innerHTML=e.name,t.append(u);var l=document.createElement("p");l.innerHTML=e.neighborhood,t.append(l);var d=document.createElement("p");d.innerHTML=e.address,t.append(d);var m=document.createElement("a");return m.innerHTML="View Details",m.setAttribute("role","button"),m.setAttribute("aria-label",e.name),m.href=DBHelper.urlForRestaurant(e),t.append(m),t},addMarkersToMap=function(){(0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};document.onreadystatechange=function(){if("complete"===document.readyState)new Blazy({selector:".restaurant-img",offset:10})};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsibmVpZ2hib3Job29kcyIsInJlc3RhdXJhbnRzIiwiY3Vpc2luZXMiLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImZldGNoTmVpZ2hib3Job29kcyIsIkRCSGVscGVyIiwiZXJyb3IiLCJzZWxmIiwiY29uc29sZSIsImZpbGxOZWlnaGJvcmhvb2RzSFRNTCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInNlbGVjdCIsImdldEVsZW1lbnRCeUlkIiwiZm9yRWFjaCIsIm5laWdoYm9yaG9vZCIsImNyZWF0ZUVsZW1lbnQiLCJvcHRpb24iLCJ2YWx1ZSIsImZldGNoQ3Vpc2luZXMiLCJmaWxsQ3Vpc2luZXNIVE1MIiwiY3Vpc2luZSIsImlubmVySFRNTCIsImFwcGVuZCIsImxhdCIsImxuZyIsIm1hcENvbnRhaW5lciIsIm1hcENsaWNrZWQiLCJ3aW5kb3ciLCJsb2MiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiY2VudGVyIiwic2Nyb2xsd2hlZWwiLCJ1cGRhdGVSZXN0YXVyYW50cyIsImNTZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiblNlbGVjdCIsInJlc2V0UmVzdGF1cmFudHMiLCJjbGVhbkltYWdlQ2FjaGUiLCJtYXJrZXJzIiwibSIsInNldE1hcCIsInVsIiwiZmlsbFJlc3RhdXJhbnRzSFRNTCIsInJlc3RhdXJhbnQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwiY2xhc3NOYW1lIiwibGFyZ2VTb3VyY2VXZWJwIiwibWVkaWEiLCJzZXRBdHRyaWJ1dGUiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJ0eXBlIiwicGljdHVyZSIsImxhcmdlU291cmNlIiwibWVkaXVtU291cmNlV2VicCIsIm1lZGl1bVNvdXJjZSIsInNvdXJjZVdlYnAiLCJpbWFnZSIsImFkZHJlc3MiLCJuYW1lIiwic3JjIiwibW9yZSIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIm1hcmtlciIsInVybCIsInB1c2giLCJyZWFkeVN0YXRlIiwic2VsZWN0b3IiLCJvZmZzZXQiXSwibWFwcGluZ3MiOiJhQUFBLElBQ0VBLElBREVDLGlCQUFBQSxFQUNGRCxtQkFBQUEsRUFERkUsY0FBQUEsRUFFRUEsUUFBQUEsR0FPRkMsU0FBU0MsaUJBQWlCLG1CQUFvQixTQUFDQyxHQUM3Q0MscUJBREZILGtCQVFBLElBQUlHLG1CQUFxQixXQUN2QkMsU0FBU0QsbUJBQW1CLFNBQUNFLEVBQU9SLEdBRGxDTSxFQUNGQyxRQUFTRCxNQUFBQSxJQUNNRyxLQUFBVCxjQUFBQSxFQUNYVSw0QkFRTkMsc0JBQUEsV0FBQSxJQUFBWCxFQUFBLEVBQUFZLFVBQUFDLGFBQUFDLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFBSCxLQUFBVCxjQUlRZSxFQUFTWixTQUFTYSxlQUFlLHdCQUN2Q2hCLEVBQWNpQixRQUFRLFNBQUFDLEdBRnBCUCxJQUFBQSxFQUFBQSxTQUF3QlEsY0FBeEJSLFVBQWdFUyxFQUF2Q3BCLFVBQXVDa0IsRUFLaEVFLEVBQU9DLE1BQVFILEVBSmpCSCxFQUFNQSxPQUFTWixNQURqQm1CLGNBQUEsV0FjRWYsU0FBU2UsY0FBYyxTQUFDZCxFQUFPTixHQUpqQ00sRUFNTUUsUUFBUUYsTUFBTUEsSUFIaEJjLEtBQUFBLFNBQWdCcEIsRUFDbEJLLHVCQUFBZ0IsaUJBQUEsV0FBQSxJQUFBckIsRUFBQSxFQUFBVSxVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBQUgsS0FBQVAsU0FERmEsRUFBQVosU0FBQWEsZUFBQSxtQkFXQWQsRUFBQWUsUUFBQSxTQUFBTyxHQU9JLElBQU1KLEVBQVNqQixTQUFTZ0IsY0FBYyxVQUN0Q0MsRUFBT0ssVUFBWUQsRUFMbkJELEVBQUFBLE1BQUFBLEVBQWlEUixFQUE3QmIsT0FBNkJrQixNQU1qREEsT0FBQUEsUUFBQSxXQUNBTCxJQUFB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QUEsa0JBQW9DUixFQUFBZ0IsUUFBdEYsSUFDQUgsRUFBQUEsT0FBYUosR0FlYixJQUFNUSxFQUFPbEUsU0FBU2dCLGNBQWMsTUFacENrRCxFQUFNSCxVQUFhL0QsRUFBU2dCLEtBQzVCK0MsRUFBQUEsT0FBQUEsR0FFQUosSUFBQUEsRUFBZUksU0FBZi9DLGNBQUEsS0FjQUQsRUFBYU8sVUFBWTJCLEVBQVdsQyxhQVpwQ3FDLEVBQUE3QixPQUFNeUMsR0FFTkEsSUFBTUcsRUFBTW5FLFNBQUFnQixjQUFBLEtBQ1pnRCxFQUFNUixVQUFhUCxFQUFZN0MsUUFDL0I0RCxFQUFBQSxPQUFBQyxHQWVBLElBQU1HLEVBQU9wRSxTQUFTZ0IsY0FBYyxLQU5wQ29DLE9BTkFnQixFQUFNRixVQUFPbEUsZUFDYmtFLEVBQUs1QyxhQUFZMkIsT0FBQUEsVUFDakJHLEVBQUc3QixhQUFILGFBQUEwQixFQUFBaUIsTUFjQUUsRUFBS0MsS0FBT2pFLFNBQVNrRSxpQkFBaUJyQixHQVp0Q0csRUFBQTdCLE9BQU1SLEdBRUhRLEdBTUg0QixnQkFBc0JuQyxZQUF0QixFQUFBUCxVQUFBQyxhQUFBQyxJQUFBRixVQUFBLEdBQUFBLFVBQUEsR0FBb0NILEtBQXBDUixhQUNLd0IsUUFBWSxTQUFBMkIsR0FFakJtQixJQUFLWixFQUFMcEQsU0FBa0JtRSx1QkFBbEJ0QixFQUFBM0MsS0FBQXdCLEtBQ0FzQyxPQUFBcEMsS0FBWTVCLE1BQUFBLFlBQVNrRSxFQUFpQnJCLFFBQXRDLFdBQ0cxQixPQUFPNkMsU0FBVkMsS0FBQUcsRUFBQUMsTUFFQW5FLEtBQU84QyxRQUFQc0IsS0FBQUYsTUFNd0R4RSxTQUFuQ0YsbUJBQW1DLFdBZXhELEdBQTRCLGFBQXhCRSxTQUFTMkUsV0FkRDdELElBQUFBLE1BQVEsQ0FDbEI4RCxTQUFBLGtCQUNBQyxPQUFNTCIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxuICBuZWlnaGJvcmhvb2RzLFxuICBjdWlzaW5lcztcbnZhciBtYXA7XG52YXIgbWFya2VycyA9IFtdO1xuXG4vKipcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xuICBmZXRjaEN1aXNpbmVzKCk7XG59KTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbnZhciBmZXRjaE5laWdoYm9yaG9vZHMgPSAoKSA9PiB7XG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcbiAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vKipcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXG4gKi9cbnZhciBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xuICB9KTtcbn07XG5cbi8qKlxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cbiAqL1xudmFyIGZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XG4gIERCSGVscGVyLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsZi5jdWlzaW5lcyA9IGN1aXNpbmVzO1xuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG4vKipcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxuICovXG52YXIgZmlsbEN1aXNpbmVzSFRNTCA9IChjdWlzaW5lcyA9IHNlbGYuY3Vpc2luZXMpID0+IHtcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xuXG4gIGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XG4gICAgb3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcbiAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG4gKi9cbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuICBsZXQgbG9jID0ge1xuICAgIGxhdDogNDAuNzIyMjE2LFxuICAgIGxuZzogLTczLjk4NzUwMVxuICB9O1xuXG4gIHZhciBtYXBDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG4gIHZhciBtYXBDbGlja2VkID0gZmFsc2U7XG4gIG1hcENvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFtYXBDbGlja2VkKSB7XG4gICAgICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG4gICAgICAgIHpvb206IDEyLFxuICAgICAgICBjZW50ZXI6IGxvYyxcbiAgICAgICAgc2Nyb2xsd2hlZWw6IGZhbHNlXG4gICAgICB9KTtcblxuICAgICAgYWRkTWFya2Vyc1RvTWFwKCk7XG4gICAgICBtYXBDbGlja2VkID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXG4gKi9cbnZhciB1cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcbiAgY29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcbiAgY29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xuXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcblxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG4gICAgaWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcbiAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXG4gKi9cbnZhciByZXNldFJlc3RhdXJhbnRzID0gKHJlc3RhdXJhbnRzKSA9PiB7XG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XG4gIHVsLmlubmVySFRNTCA9ICcnO1xuXG4gIC8vQ2xlYW4gaW1hZ2VzIGNhY2hlXG4gIERCSGVscGVyLmNsZWFuSW1hZ2VDYWNoZSgpO1xuXG4gIC8vIFJlbW92ZSBhbGwgbWFwIG1hcmtlcnNcbiAgc2VsZi5tYXJrZXJzLmZvckVhY2gobSA9PiBtLnNldE1hcChudWxsKSk7XG4gIHNlbGYubWFya2VycyA9IFtdO1xuICBzZWxmLnJlc3RhdXJhbnRzID0gcmVzdGF1cmFudHM7XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbnZhciBmaWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuICBjb25zdCB1bCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50cy1saXN0Jyk7XG4gIHVsLmlubmVySFRNTCA9ICcnO1xuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XG4gIH0pO1xuICBhZGRNYXJrZXJzVG9NYXAoKTtcbn07XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTC5cbiAqL1xudmFyIGNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBsaS5jbGFzc05hbWUgPSAncmVzdGF1cmFudCc7XG5cbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcbiAgbGkuYXBwZW5kKHBpY3R1cmUpO1xuXG4gIGNvbnN0IGxhcmdlU291cmNlV2VicCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICBsYXJnZVNvdXJjZVdlYnAubWVkaWEgPSAnKG1pbi13aWR0aDogNzUwcHgpJztcbiAgbGFyZ2VTb3VyY2VXZWJwLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmNzZXQnLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnLTgwMF9sYXJnZS53ZWJwJyk7XG4gIGxhcmdlU291cmNlV2VicC50eXBlID0gJ2ltYWdlL3dlYnAnO1xuICBwaWN0dXJlLmFwcGVuZChsYXJnZVNvdXJjZVdlYnApO1xuXG4gIGNvbnN0IGxhcmdlU291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gIGxhcmdlU291cmNlLm1lZGlhID0gJyhtaW4td2lkdGg6IDc1MHB4KSc7XG4gIGxhcmdlU291cmNlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmNzZXQnLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnLTgwMF9sYXJnZS5qcGcnKTtcbiAgbGFyZ2VTb3VyY2UudHlwZSA9ICdpbWFnZS9qcGVnJztcbiAgcGljdHVyZS5hcHBlbmQobGFyZ2VTb3VyY2UpO1xuXG4gIGNvbnN0IG1lZGl1bVNvdXJjZVdlYnAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzb3VyY2UnKTtcbiAgbWVkaXVtU291cmNlV2VicC5tZWRpYSA9ICcobWluLXdpZHRoOiA1MDBweCknO1xuICBtZWRpdW1Tb3VyY2VXZWJwLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmNzZXQnLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnX21lZGl1bS53ZWJwJyk7XG4gIG1lZGl1bVNvdXJjZVdlYnAudHlwZSA9ICdpbWFnZS93ZWJwJztcbiAgcGljdHVyZS5hcHBlbmQobWVkaXVtU291cmNlV2VicCk7XG5cbiAgY29uc3QgbWVkaXVtU291cmNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gIG1lZGl1bVNvdXJjZS5tZWRpYSA9ICcobWluLXdpZHRoOiA1MDBweCknO1xuICBtZWRpdW1Tb3VyY2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArICdfbWVkaXVtLmpwZycpO1xuICBtZWRpdW1Tb3VyY2UudHlwZSA9ICdpbWFnZS9qcGVnJztcbiAgcGljdHVyZS5hcHBlbmQobWVkaXVtU291cmNlKTtcblxuICBjb25zdCBzb3VyY2VXZWJwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XG4gIHNvdXJjZVdlYnAuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSArICcud2VicCcpO1xuICBzb3VyY2VXZWJwLnR5cGUgPSAnaW1hZ2Uvd2VicCc7XG4gIHBpY3R1cmUuYXBwZW5kKHNvdXJjZVdlYnApO1xuXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG4gIGltYWdlLnNyYyA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUFBQUFDSDVCQUVLQUFFQUxBQUFBQUFCQUFFQUFBSUNUQUVBT3c9PSc7XG4gIGltYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmMnLCBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkgKyAnLmpwZycpO1xuICBpbWFnZS5hbHQgPSByZXN0YXVyYW50Lm5hbWUgKyAnIGlzIGEgJyArIHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlICsgJyByZXN0YXVyYW50IGluICcgKyByZXN0YXVyYW50LmFkZHJlc3MgKyAnLic7XG4gIHBpY3R1cmUuYXBwZW5kKGltYWdlKTtcblxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG4gIGxpLmFwcGVuZChuYW1lKTtcblxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcbiAgbGkuYXBwZW5kKG5laWdoYm9yaG9vZCk7XG5cbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XG4gIGxpLmFwcGVuZChhZGRyZXNzKTtcblxuICBjb25zdCBtb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xuICBtb3JlLnNldEF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcbiAgbW9yZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCByZXN0YXVyYW50Lm5hbWUpO1xuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICBsaS5hcHBlbmQobW9yZSk7XG5cbiAgcmV0dXJuIGxpO1xufTtcblxuLyoqXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxuICovXG52YXIgYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xuICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsO1xuICAgIH0pO1xuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBJbml0aWFsaXplIGItbGF6eVxuICovXG5kb2N1bWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSAoKSA9PiB7XG4gIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG4gICAgdmFyIGJMYXp5ID0gbmV3IEJsYXp5KHtcbiAgICAgIHNlbGVjdG9yOiAnLnJlc3RhdXJhbnQtaW1nJyxcbiAgICAgIG9mZnNldDogMTBcbiAgICB9KTtcbiAgfVxufTtcbiJdfQ==
